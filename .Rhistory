# Create a function to generate individual plots
create_decoupling_plot <- function(country_name, data = tapio_decoupling) {
country_data <- data %>% filter(Country == country_name)
p <- ggplot(country_data, aes(x = Year, y = DI)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
geom_hline(yintercept = 1, linetype = "dashed", color = "gray50") +
annotate("rect", xmin = min(country_data$Year), xmax = max(country_data$Year),
ymin = -Inf, ymax = 0, alpha = 0.15, fill = "green") +
annotate("rect", xmin = min(country_data$Year), xmax = max(country_data$Year),
ymin = 0, ymax = 1, alpha = 0.15, fill = "yellow") +
annotate("rect", xmin = min(country_data$Year), xmax = max(country_data$Year),
ymin = 1, ymax = Inf, alpha = 0.15, fill = "red") +
geom_line(linewidth = 1.2, color = "#1f77b4") +
geom_point(aes(color = Decoupling_Type), size = 3) +
labs(
title = paste("Decoupling Trajectory:", country_name),
subtitle = "Tapio Decoupling Index (1975-2022)",
x = "Year",
y = "Decoupling Index (DI)",
color = "Decoupling State"
) +
theme_bw() +
theme(
plot.title = element_text(face = "bold", size = 14),
legend.position = "bottom"
) +
scale_x_continuous(breaks = seq(1975, 2022, by = 5)) +
scale_color_manual(values = c("Absolute Decoupling" = "#2ca02c",
"Relative Decoupling" = "#ff7f0e",
"Non-Decoupling" = "#d62728",
"Stagnant" = "#7f7f7f",
"Other" = "#9467bd"))
return(p)
}
# Generate plots for specific countries
countries_to_plot <- c("China", "India", "Japan", "South Korea", "Indonesia")
for (country in countries_to_plot) {
plot <- create_decoupling_plot(country)
print(plot)
# Plot 1A: Decoupling Trajectories Over Time - Faceted by Country
decoupling_trajectory_faceted <- ggplot(tapio_decoupling,
aes(x = Year, y = DI, color = Country)) +
# Reference lines
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
geom_hline(yintercept = 1, linetype = "dashed", color = "gray50") +
# Add shaded regions for decoupling types (now per facet)
geom_rect(data = data.frame(xmin = min(tapio_decoupling$Year),
xmax = max(tapio_decoupling$Year),
ymin = -Inf, ymax = 0),
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
inherit.aes = FALSE, alpha = 0.1, fill = "green") +
geom_rect(data = data.frame(xmin = min(tapio_decoupling$Year),
xmax = max(tapio_decoupling$Year),
ymin = 0, ymax = 1),
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
inherit.aes = FALSE, alpha = 0.1, fill = "yellow") +
geom_rect(data = data.frame(xmin = min(tapio_decoupling$Year),
xmax = max(tapio_decoupling$Year),
ymin = 1, ymax = Inf),
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
inherit.aes = FALSE, alpha = 0.1, fill = "red") +
# Data points and lines
geom_line(linewidth = 1.2) +
geom_point(aes(shape = Decoupling_Type), size = 3) +
# Facet by country
facet_wrap(~ Country, ncol = 2, scales = "free_y") +
# Labels and titles
labs(
title = "Tapio Decoupling Analysis: Environmental-Economic Dynamics by Country (1975-2022)",
subtitle = expression("DI = (ΔCO"[2]~"/ CO"[2]~") / (ΔGDP / GDP) | DI<0=Absolute ◼ 0<DI<1=Relative ◼ DI>1=Non-decoupling"),
x = "Year",
y = "Decoupling Index (DI)",
color = "Country",
shape = "Decoupling Type"
) +
# Theme and formatting
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
plot.subtitle = element_text(size = 12, hjust = 0.5, margin = margin(b = 15)),
legend.position = "bottom",
legend.box = "vertical",
panel.grid.minor = element_blank(),
strip.background = element_rect(fill = "#2c3e50"),
strip.text = element_text(face = "bold", color = "white", size = 11),
axis.text.x = element_text(angle = 45, hjust = 1)
) +
# Scales
scale_x_continuous(breaks = seq(1975, 2022, by = 10)) +
scale_color_brewer(palette = "Set1") +
scale_shape_manual(values = c(16, 17, 15, 8, 4))
print(decoupling_trajectory_faceted)
# Plot 1A: Decoupling Trajectories Over Time - Faceted by Country
decoupling_trajectory_faceted <- ggplot(tapio_decoupling,
aes(x = Year, y = DI, color = Country)) +
# Reference lines
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
geom_hline(yintercept = 1, linetype = "dashed", color = "gray50") +
# Add shaded regions for decoupling types (now per facet)
geom_rect(data = data.frame(xmin = min(tapio_decoupling$Year),
xmax = max(tapio_decoupling$Year),
ymin = -Inf, ymax = 0),
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
inherit.aes = FALSE, alpha = 0.1, fill = "green") +
geom_rect(data = data.frame(xmin = min(tapio_decoupling$Year),
xmax = max(tapio_decoupling$Year),
ymin = 0, ymax = 1),
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
inherit.aes = FALSE, alpha = 0.1, fill = "yellow") +
geom_rect(data = data.frame(xmin = min(tapio_decoupling$Year),
xmax = max(tapio_decoupling$Year),
ymin = 1, ymax = Inf),
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
inherit.aes = FALSE, alpha = 0.1, fill = "red") +
# Data points and lines
geom_line(linewidth = 1.2) +
geom_point(aes(shape = Decoupling_Type), size = 3) +
# Facet by country
facet_wrap(~ Country, ncol = 2, scales = "free_y") +
# Labels and titles
labs(
title = "Tapio Decoupling Analysis: Environmental-Economic Dynamics by Country (1975-2022)",
subtitle = expression("DI = (ΔCO"[2]~"/ CO"[2]~") / (ΔGDP / GDP) | DI<0=Absolute ◼ 0<DI<1=Relative ◼ DI>1=Non-decoupling"),
x = "Year",
y = "Decoupling Index (DI)",
color = "Country",
shape = "Decoupling Type"
) +
# Theme and formatting
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
plot.subtitle = element_text(size = 12, hjust = 0.5, margin = margin(b = 15)),
legend.position = "bottom",
legend.box = "vertical",
panel.grid.minor = element_blank(),
strip.background = element_rect(fill = "#2c3e50"),
strip.text = element_text(face = "bold", color = "white", size = 11),
axis.text.x = element_text(angle = 45, hjust = 1)
) +
# Scales
scale_x_continuous(breaks = seq(1975, 2022, by = 10)) +
scale_color_brewer(palette = "Set1") +
scale_shape_manual(values = c(16, 17, 15, 8, 4))
print(decoupling_trajectory_faceted)
print(decoupling_trajectory_plot)
## Decoupling Analysis
# Calculate Tapio Decoupling Indicators
tapio_decoupling <- final_trend_data %>%
arrange(Country, Year) %>%
group_by(Country) %>%
mutate(
# Calculate changes relative to baseline (1975 or your chosen baseline year)
delta_EI = (Total_CO2 - lag(Total_CO2)) / lag(Total_CO2),
delta_GDP = (GDP - lag(GDP)) / lag(GDP),
# Tapio Decoupling Index (DI)
DI = delta_EI / delta_GDP
) %>%
# Remove the first year (no lag values)
filter(!is.na(DI)) %>%
# Classify decoupling types
mutate(
Decoupling_Type = case_when(
DI < 0 & delta_EI < 0 & delta_GDP > 0 ~ "Absolute Decoupling",
DI > 0 & DI < 1 & delta_EI > 0 & delta_GDP > 0 ~ "Relative Decoupling",
DI > 1 & delta_EI > 0 & delta_GDP > 0 ~ "Non-Decoupling",
abs(delta_EI) < 0.1 & delta_GDP <= 0 ~ "Stagnant",
TRUE ~ "Other"
),
# Create a factor with meaningful ordering
Decoupling_Type = factor(Decoupling_Type,
levels = c("Absolute Decoupling",
"Relative Decoupling",
"Non-Decoupling",
"Stagnant",
"Other"))
) %>%
ungroup()
# View the classification summary
decoupling_summary <- tapio_decoupling %>%
count(Country, Decoupling_Type) %>%
pivot_wider(names_from = Decoupling_Type, values_from = n, values_fill = 0)
print(decoupling_summary)
## Plot 1: Decoupling Trajectories Over Time
decoupling_trajectory_plot <- ggplot(tapio_decoupling,
aes(x = Year, y = DI, color = Country)) +
# Reference lines
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
geom_hline(yintercept = 1, linetype = "dashed", color = "gray50") +
# Add shaded regions for decoupling types
annotate("rect", xmin = min(tapio_decoupling$Year), xmax = max(tapio_decoupling$Year),
ymin = -Inf, ymax = 0, alpha = 0.1, fill = "green") +
annotate("rect", xmin = min(tapio_decoupling$Year), xmax = max(tapio_decoupling$Year),
ymin = 0, ymax = 1, alpha = 0.1, fill = "yellow") +
annotate("rect", xmin = min(tapio_decoupling$Year), xmax = max(tapio_decoupling$Year),
ymin = 1, ymax = Inf, alpha = 0.1, fill = "red") +
# Data points and lines
geom_line(linewidth = 1.2, alpha = 0.8) +
geom_point(aes(shape = Decoupling_Type), size = 3) +
# Labels and titles
labs(
title = "Tapio Decoupling Analysis: Environmental-Economic Dynamics (1975-2022)",
subtitle = expression("DI = (ΔCO"[2]~"/ CO"[2]~") / (ΔGDP / GDP) | DI<0=Absolute ◼ 0<DI<1=Relative ◼ DI>1=Non-decoupling"),
x = "Year",
y = "Decoupling Index (DI)",
color = "Country",
shape = "Decoupling Type"
) +
# Theme and formatting
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
plot.subtitle = element_text(size = 12, hjust = 0.5),
legend.position = "bottom",
legend.box = "vertical",
panel.grid.minor = element_blank()
) +
# Scales
scale_x_continuous(breaks = seq(1975, 2022, by = 5)) +
scale_y_continuous(limits = c(-2, 3), breaks = seq(-2, 3, by = 0.5)) +
scale_color_brewer(palette = "Set1") +
scale_shape_manual(values = c(16, 17, 15, 8, 4))  # Different shapes for decoupling types
print(decoupling_trajectory_plot)
library(readr)
EDGAR_emiss_on_UCDB_v2024 <- read_csv("EDGAR_emiss_on_UCDB_v2024.csv")
View(EDGAR_emiss_on_UCDB_v2024)
library(readr)
GDP <- read_csv("GDP.csv")
View(GDP)
### Data Cleaning
## Install & load data transformation function package
install.packages("tidyverse")
library(tidyverse)
## Install & load data visualisation packages
install.packages("patchwork")
library(patchwork)
install.packages("ggplot2")
library(ggplot2)
## Step 1:Load Data
raw_data <- read_csv("EDGAR_emiss_on_UCDB_v2024.csv")
gdp_data <- read_csv("GDP.csv")
# View the structure to confirm column names
glimpse(raw_data)
head(raw_data)
## Step 2:Filter target countries
target_countries <- c("China", "India", "Japan", "South Korea", "Indonesia")
cleaned_data <- raw_data %>%
# Filter target countries
filter(UC_country %in% target_countries) %>%
# Select all EMI columns for CO2 across all years and sectors
select(UC_name, UC_country, matches("EMI_CO2_.*_(1975|1990|2000|2005|2010|2015|2020|2022)"))
# Reshape GDP data from wide to long format
gdp_long <- gdp_data %>%
select(Country, `1975`, `1990`, `2000`, `2005`, `2010`, `2015`, `2020`, `2022`) %>%
pivot_longer(
cols = -Country,
names_to = "Year",
values_to = "GDP"
) %>%
mutate(Year = as.numeric(Year))
### Step 3: Pivot to long format to extract Year and Sector from column names
long_data <- cleaned_data %>%
pivot_longer(
cols = starts_with("EMI_"),
names_to = "Emission_Variable",
values_to = "Emission_Value"
) %>%
## Extract Year, Sector, and Pollutant from the column name
mutate(
# Extract year (last 4 digits)
Year = str_extract(Emission_Variable, "\\d{4}$"),
# Extract sector (between CO2_ and _Year)
Sector = str_extract(Emission_Variable, "CO2_(.*?)_\\d{4}"),
Sector = str_remove(Sector, "CO2_"),
Sector = str_remove(Sector, "_\\d{4}"),
Pollutant = "CO2"
) %>%
select(-Emission_Variable) %>%
mutate(Year = as.numeric(Year))
## Step 4: Aggregate from city level to country level
# For total CO2 by country and year (for trend analysis)
country_year_totals <- long_data %>%
group_by(UC_country, Year) %>%
summarise(
Total_CO2 = sum(Emission_Value, na.rm = TRUE),
.groups = 'drop'
) %>%
rename(Country = UC_country)
# For sector-level data (for sector contribution analysis)
country_sector_year <- long_data %>%
group_by(UC_country, Sector, Year) %>%
summarise(
Sector_CO2 = sum(Emission_Value, na.rm = TRUE),
.groups = 'drop'
) %>%
rename(Country = UC_country)
## STEP 6: Merge emissions with GDP data
final_trend_data <- country_year_totals %>%
inner_join(gdp_long, by = c("Country", "Year")) %>%
mutate(Carbon_Intensity = Total_CO2 / GDP)
## STEP 7: Save cleaned datasets
write_csv(final_trend_data, "country_co2_gdp_trends.csv")
write_csv(country_sector_year, "country_sector_co2.csv")
### Data Analysis
# Package for axis formatting
install.packages("scales")
library(scales)
# Load your cleaned data
final_trend_data <- read_csv("country_co2_gdp_trends.csv")
# Calculate CO₂ as percentage of GDP
ratio_data <- final_trend_data %>%
mutate(CO2_as_pct_GDP = (Total_CO2 / GDP) * 100) %>%
select(Country, Year, CO2_as_pct_GDP)
## Plot 1: Carbon Intensity Trends
carbon_intensity_plot <- ggplot(final_trend_data,
aes(x = Year, y = Carbon_Intensity, color = Country)) +
# Thicker, more prominent lines
geom_line(linewidth = 1.5, alpha = 0.8) +
geom_point(size = 3, alpha = 0.8) +
# Labels and title
labs(
title = "Carbon Intensity Trends in Major Asian Economies",
x = "Year",
y = expression("Carbon Intensity (ton CO"[2]~"/ USD GDP)"),
color = "Country",
) +
# Theme
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
plot.subtitle = element_text(size = 12, hjust = 0.5, lineheight = 1.2),
plot.caption = element_text(face = "italic", color = "gray50"),
legend.position = "bottom",
legend.title = element_text(face = "bold"),
axis.title = element_text(face = "bold"),
panel.grid.minor = element_blank(),
plot.margin = margin(1, 1, 1, 1, "cm")
) +
# Color scheme (colorblind friendly)
scale_color_brewer(palette = "Set1") +
# Axis formatting
scale_x_continuous(breaks = unique(final_trend_data$Year)) +
scale_y_continuous(labels = comma_format())
# Display the plot
print(carbon_intensity_plot)
## Plot 2: Percentage Change from Baseline (1975)
# Calculate percentage change in Carbon Intensity for each country (1975 baseline)
carbon_intensity_change <- final_trend_data %>%
arrange(Country, Year) %>%
group_by(Country) %>%
mutate(
pct_change = (Carbon_Intensity / first(Carbon_Intensity) - 1) * 100,
abs_change = Carbon_Intensity - first(Carbon_Intensity)
) %>%
ungroup()
# plot
pct_change_plot <- ggplot(carbon_intensity_change,
aes(x = Year, y = pct_change, color = Country)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red", linewidth = 1) +
geom_line(linewidth = 1.3) +
geom_point(size = 2.5) +
labs(
title = "Carbon Intensity Change From 1975",
x = "Year",
y = "Percentage Change (%)",
color = "Country",
fill = "Country"
) +
theme_bw() +
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
plot.subtitle = element_text(size = 12, hjust = 0.5),
legend.position = "bottom",
panel.grid.minor = element_blank()
) +
scale_x_continuous(breaks = seq(1975, 2022, by = 5)) +
scale_y_continuous(labels = function(x) paste0(x, "%")) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1") +
geom_text(data = carbon_intensity_change %>%
group_by(Country) %>%
filter(Year == max(Year)),
aes(label = paste0(round(pct_change, 1), "%")),
nudge_x = 1, nudge_y = 2, size = 3.5, show.legend = FALSE)
# Display the plot
print(pct_change_plot)
## Plot 3: GDP & CO2 Percentage change from 1975
# Calculate percentage change for both GDP and CO2 from 1975 baseline
co2_gdp_change <- final_trend_data %>%
arrange(Country, Year) %>%
group_by(Country) %>%
mutate(
gdp_pct_change = (GDP / first(GDP) - 1) * 100,
co2_pct_change = (Total_CO2 / first(Total_CO2) - 1) * 100
) %>%
ungroup()
# Convert to long format for all countries
all_countries_long <- co2_gdp_change %>%
select(Country, Year, gdp_pct_change, co2_pct_change) %>%
pivot_longer(cols = c(gdp_pct_change, co2_pct_change),
names_to = "Variable", values_to = "Percentage_Change") %>%
mutate(Variable = case_when(
Variable == "gdp_pct_change" ~ "GDP",
Variable == "co2_pct_change" ~ "CO2 Emissions"
))
# Small multiples for all countries
small_multiples_dual <- ggplot(all_countries_long, aes(x = Year, y = Percentage_Change, color = Variable)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50", linewidth = 0.5) +
geom_line(linewidth = 1) +
geom_point(size = 1.5, alpha = 0.7) +
facet_wrap(~ Country, ncol = 2) +
labs(
title = "Percentage Change in GDP vs CO2 Emissions by Country (1975-2022)",
subtitle = "Baseline = 1975 (0%) - Shows decoupling patterns across major Asian economies",
x = "Year",
y = "Percentage Change from 1975 (%)",
color = "Variable"
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
plot.subtitle = element_text(size = 12, hjust = 0.5),
strip.background = element_rect(fill = "#2c3e50"),
strip.text = element_text(face = "bold", color = "white"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
panel.grid.minor = element_blank()
) +
scale_x_continuous(breaks = seq(1975, 2022, by = 10)) +
scale_y_continuous(labels = function(x) paste0(x, "%")) +
scale_color_manual(values = c("GDP" = "#2E8B57", "CO2 Emissions" = "#E41A1C"))
print(small_multiples_dual)
## Decoupling Analysis
# Calculate Tapio Decoupling Indicators
tapio_decoupling <- final_trend_data %>%
arrange(Country, Year) %>%
group_by(Country) %>%
mutate(
# Calculate changes relative to baseline (1975 or your chosen baseline year)
delta_EI = (Total_CO2 - lag(Total_CO2)) / lag(Total_CO2),
delta_GDP = (GDP - lag(GDP)) / lag(GDP),
# Tapio Decoupling Index (DI)
DI = delta_EI / delta_GDP
) %>%
# Remove the first year (no lag values)
filter(!is.na(DI)) %>%
# Classify decoupling types
mutate(
Decoupling_Type = case_when(
DI < 0 & delta_EI < 0 & delta_GDP > 0 ~ "Absolute Decoupling",
DI > 0 & DI < 1 & delta_EI > 0 & delta_GDP > 0 ~ "Relative Decoupling",
DI > 1 & delta_EI > 0 & delta_GDP > 0 ~ "Non-Decoupling",
abs(delta_EI) < 0.1 & delta_GDP <= 0 ~ "Stagnant",
TRUE ~ "Other"
),
# Create a factor with meaningful ordering
Decoupling_Type = factor(Decoupling_Type,
levels = c("Absolute Decoupling",
"Relative Decoupling",
"Non-Decoupling",
"Stagnant",
"Other"))
) %>%
ungroup()
# View the classification summary
decoupling_summary <- tapio_decoupling %>%
count(Country, Decoupling_Type) %>%
pivot_wider(names_from = Decoupling_Type, values_from = n, values_fill = 0)
print(decoupling_summary)
## Plot 1: Decoupling Trajectories Over Time
decoupling_trajectory_plot <- ggplot(tapio_decoupling,
aes(x = Year, y = DI, color = Country)) +
# Reference lines
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
geom_hline(yintercept = 1, linetype = "dashed", color = "gray50") +
# Add shaded regions for decoupling types
annotate("rect", xmin = min(tapio_decoupling$Year), xmax = max(tapio_decoupling$Year),
ymin = -Inf, ymax = 0, alpha = 0.1, fill = "green") +
annotate("rect", xmin = min(tapio_decoupling$Year), xmax = max(tapio_decoupling$Year),
ymin = 0, ymax = 1, alpha = 0.1, fill = "yellow") +
annotate("rect", xmin = min(tapio_decoupling$Year), xmax = max(tapio_decoupling$Year),
ymin = 1, ymax = Inf, alpha = 0.1, fill = "red") +
# Data points and lines
geom_line(linewidth = 1.2, alpha = 0.8) +
geom_point(aes(shape = Decoupling_Type), size = 3) +
# Labels and titles
labs(
title = "Tapio Decoupling Analysis: Environmental-Economic Dynamics (1975-2022)",
subtitle = expression("DI = (ΔCO"[2]~"/ CO"[2]~") / (ΔGDP / GDP) | DI<0=Absolute ◼ 0<DI<1=Relative ◼ DI>1=Non-decoupling"),
x = "Year",
y = "Decoupling Index (DI)",
color = "Country",
shape = "Decoupling Type"
) +
# Theme and formatting
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
plot.subtitle = element_text(size = 12, hjust = 0.5),
legend.position = "bottom",
legend.box = "vertical",
panel.grid.minor = element_blank()
) +
# Scales
scale_x_continuous(breaks = seq(1975, 2022, by = 5)) +
scale_y_continuous(limits = c(-2, 3), breaks = seq(-2, 3, by = 0.5)) +
scale_color_brewer(palette = "Set1") +
scale_shape_manual(values = c(16, 17, 15, 8, 4))  # Different shapes for decoupling types
print(decoupling_trajectory_plot)
print(small_multiples_dual)
## Install & load data transformation function package
install.packages("tidyverse")
