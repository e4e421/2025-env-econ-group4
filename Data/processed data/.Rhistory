if (di > 1.2) {
"expansive negative decoupling"
} else if (di > 0.8 && di < 1.2) {
"expansive coupling"
} else if (di > 0 && di < 0.8) {
"weak decoupling"
} else {
NA_character_
}
} else if (delta_c < 0 && delta_gdp > 0) {
if (di < 0) {
"strong decoupling"
} else {
NA_character_
}
} else if (delta_c < 0 && delta_gdp < 0) {
if (di > 1.2) {
"recessive decoupling"
} else if (di > 0.8 && di < 1.2) {
"recessive coupling"
} else if (di > 0 && di < 0.8) {
"weak negative decoupling"
} else {
NA_character_
}
} else if (delta_c > 0 && delta_gdp < 0) {
if (di < 0) {
"strong negative decoupling"
} else {
NA_character_
}
} else {
NA_character_
}
}
# 3.2 Compute year to year Tapio Indices
# Computing decoupling between consecutive years gives a detailed time path of DI for each country.
decoupling_results <- decoupling_clean %>%
group_by(Country) %>%
arrange(Year, .by_group = TRUE) %>%
mutate(
# Level changes (T - B)
delta_CO2  = Total_CO2_Mt - lag(Total_CO2_Mt),
delta_GDP  = GDP_USD - lag(GDP_USD),
# Relative changes (ΔX / X_B)
rel_CO2    = calc_pct_change(Total_CO2_Mt),
rel_GDP    = calc_pct_change(GDP_USD),
# Tapio elasticity DI = rel_CO2 / rel_GDP
DI         = rel_CO2 / rel_GDP,
# Human-readable category using Tapio states
decoupling_state = pmap_chr(
list(delta_c = rel_CO2, delta_gdp = rel_GDP, di = DI),
~ classify_tapio(..1, ..2, ..3)
)
) %>%
ungroup()
View(decoupling_results)
# Load cleaned datasets from previous processing
decoupling_data <- read_csv("decoupling_data_1973_2023.csv")
sector_data <- read_csv("sector_emissions_1973_2023.csv")
# -----------------------------------------------------------------------------
# 2. GDP AND CO2 PERCENTAGE CHANGE VISUALIZATION
# -----------------------------------------------------------------------------
# Calculate percentage change from 1973 baseline
co2_gdp_pct_change <- decoupling_data %>%
arrange(Country, Year) %>%
group_by(Country) %>%
mutate(
gdp_pct_change = (GDP_USD / first(GDP_USD) - 1) * 100,
co2_pct_change = (Total_CO2_Mt / first(Total_CO2_Mt) - 1) * 100
) %>%
ungroup()
# Plot for a specific country
Indonesia <- co2_gdp_pct_change %>%
filter(Country == "Indonesia")
# Create the dual axis plot with proper scaling
Indo <- ggplot(Indonesia, aes(x = Year)) +
# GDP line (primary y-axis)
geom_line(aes(y = gdp_pct_change, color = "GDP"), size = 1.2) +
# CO2 line (secondary y-axis)
geom_line(aes(y = co2_pct_change, color = "CO2 Emissions"), size = 1.2, linetype = "dashed") +
# Scale for primary y-axis (GDP)
scale_y_continuous(
name = "GDP Change (%)",
labels = scales::percent_format(scale = 1),
sec.axis = sec_axis(~ .,
name = "CO2 Emissions Change (%)",
labels = scales::percent_format(scale = 1)
)
) +
scale_color_manual(
name = "Indicators",
values = c("GDP" = "steelblue", "CO2 Emissions" = "darkred")
) +
labs(
title = paste("Indonesia"),
x = "Year"
) +
theme_classic() +
theme(
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
axis.title = element_text(face = "bold", size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(face = "bold")
)
# Plot for a specific country
India <- co2_gdp_pct_change %>%
filter(Country == "India")
# Create the dual axis plot with proper scaling
Ind <- ggplot(India, aes(x = Year)) +
# GDP line (primary y-axis)
geom_line(aes(y = gdp_pct_change, color = "GDP"), size = 1.2) +
# CO2 line (secondary y-axis)
geom_line(aes(y = co2_pct_change, color = "CO2 Emissions"), size = 1.2, linetype = "dashed") +
# Scale for primary y-axis (GDP)
scale_y_continuous(
name = "GDP Change (%)",
labels = scales::percent_format(scale = 1),
sec.axis = sec_axis(~ .,
name = "CO2 Emissions Change (%)",
labels = scales::percent_format(scale = 1)
)
) +
scale_color_manual(
name = "Indicators",
values = c("GDP" = "steelblue", "CO2 Emissions" = "darkred")
) +
labs(
title = paste("India"),
x = "Year"
) +
theme_classic() +
theme(
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
axis.title = element_text(face = "bold", size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(face = "bold")
)
# Plot for a specific country
China <- co2_gdp_pct_change %>%
filter(Country == "China")
# Create the dual axis plot with proper scaling
Chi <- ggplot(China, aes(x = Year)) +
# GDP line (primary y-axis)
geom_line(aes(y = gdp_pct_change, color = "GDP"), size = 1.2) +
# CO2 line (secondary y-axis)
geom_line(aes(y = co2_pct_change, color = "CO2 Emissions"), size = 1.2, linetype = "dashed") +
# Scale for primary y-axis (GDP)
scale_y_continuous(
name = "GDP Change (%)",
labels = scales::percent_format(scale = 1),
sec.axis = sec_axis(~ .,
name = "CO2 Emissions Change (%)",
labels = scales::percent_format(scale = 1)
)
) +
scale_color_manual(
name = "Indicators",
values = c("GDP" = "steelblue", "CO2 Emissions" = "darkred")
) +
labs(
title = paste("China"),
x = "Year"
) +
theme_classic() +
theme(
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
axis.title = element_text(face = "bold", size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(face = "bold")
)
# Plot for a specific country
South_Korea <- co2_gdp_pct_change %>%
filter(Country == "South Korea")
# Create the dual axis plot with proper scaling
Kor <- ggplot(South_Korea, aes(x = Year)) +
# GDP line (primary y-axis)
geom_line(aes(y = gdp_pct_change, color = "GDP"), size = 1.2) +
# CO2 line (secondary y-axis)
geom_line(aes(y = co2_pct_change, color = "CO2 Emissions"), size = 1.2, linetype = "dashed") +
# Scale for primary y-axis (GDP)
scale_y_continuous(
name = "GDP Change (%)",
labels = scales::percent_format(scale = 1),
sec.axis = sec_axis(~ .,
name = "CO2 Emissions Change (%)",
labels = scales::percent_format(scale = 1)
)
) +
scale_color_manual(
name = "Indicators",
values = c("GDP" = "steelblue", "CO2 Emissions" = "darkred")
) +
labs(
title = paste("South Korea"),
x = "Year"
) +
theme_classic() +
theme(
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
axis.title = element_text(face = "bold", size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(face = "bold")
)
# Plot for a specific country
Japan <- co2_gdp_pct_change %>%
filter(Country == "Japan")
# Create the dual axis plot with proper scaling
Jap <- ggplot(Japan, aes(x = Year)) +
# GDP line (primary y-axis)
geom_line(aes(y = gdp_pct_change, color = "GDP"), size = 1.2) +
# CO2 line (secondary y-axis)
geom_line(aes(y = co2_pct_change, color = "CO2 Emissions"), size = 1.2, linetype = "dashed") +
# Scale for primary y-axis (GDP)
scale_y_continuous(
name = "GDP Change (%)",
labels = scales::percent_format(scale = 1),
sec.axis = sec_axis(~ .,
name = "CO2 Emissions Change (%)",
labels = scales::percent_format(scale = 1)
)
) +
scale_color_manual(
name = "Indicators",
values = c("GDP" = "steelblue", "CO2 Emissions" = "darkred")
) +
labs(
title = paste("Japan"),
x = "Year"
) +
theme_classic() +
theme(
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
axis.title = element_text(face = "bold", size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(face = "bold")
)
# Combine plots
combined_patchwork <- (Indo | Ind | Chi) /
(Kor | Jap | plot_spacer()) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
# Add main title above all plots
combined_patchwork <- combined_patchwork +
plot_annotation(
title = "Percentage Change in CO2 Emissions and GDP from 1973 to 2023",
subtitle = "Baseline year: 1973 (0%) - CO2 emissions (dashed) vs GDP (solid)",
theme = theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18, margin = margin(b = 10)),
plot.subtitle = element_text(hjust = 0.5, size = 14, margin = margin(b = 20))
)
)
print(combined_patchwork)
# Save
ggsave("combined_plot_with_country_titles.png", combined_patchwork,
width = 16, height = 12, dpi = 300)
# -----------------------------------------------------------------------------
# 3. TAPIO DECOUPLING ANALYSIS
# -----------------------------------------------------------------------------
# 3.1 Define Tapio Decoupling Function
# Tapio decoupling index DI is elasticitiy:
# DI = (ΔC% / ΔGDP%) = [(C_T - C_B) / C_B] / [(GDP_T - GDP_B) / GDP_B].
# Here, C is Total_CO2_Mt and GDP is GDP_USD; B and T are consecutive years.
# Compute percentage change (ΔX / X_B) for consecutive years
calc_pct_change <- function(x) {
# Returns NA for first observation (no previous year)
c(NA, diff(x) / head(x, -1))
}
# Classify decoupling state according to Tapio’s 8 categories.
classify_tapio <- function(delta_c, delta_gdp, di) {
# Handle NA or zero GDP change defensively
if (is.na(delta_c) || is.na(delta_gdp) || is.na(di) || delta_gdp == 0) {
return(NA_character_)
}
# Thresholds follow the Macao paper using DI cut-offs 0, 0.8, 1.2.[file:1]
if (delta_c > 0 && delta_gdp > 0) {
if (di > 1.2) {
"expansive negative decoupling"
} else if (di > 0.8 && di < 1.2) {
"expansive coupling"
} else if (di > 0 && di < 0.8) {
"weak decoupling"
} else {
NA_character_
}
} else if (delta_c < 0 && delta_gdp > 0) {
if (di < 0) {
"strong decoupling"
} else {
NA_character_
}
} else if (delta_c < 0 && delta_gdp < 0) {
if (di > 1.2) {
"recessive decoupling"
} else if (di > 0.8 && di < 1.2) {
"recessive coupling"
} else if (di > 0 && di < 0.8) {
"weak negative decoupling"
} else {
NA_character_
}
} else if (delta_c > 0 && delta_gdp < 0) {
if (di < 0) {
"strong negative decoupling"
} else {
NA_character_
}
} else {
NA_character_
}
}
# 3.2 Compute year to year Tapio Indices
# Computing decoupling between consecutive years gives a detailed time path of DI for each country.
# 3.2 Compute year to year Tapio Indices
# Computing decoupling between consecutive years gives a detailed time path of DI for each country.
decoupling_results <- decoupling_data %>%
group_by(Country) %>%
arrange(Year, .by_group = TRUE) %>%
mutate(
# Level changes (T - B)
delta_CO2  = Total_CO2_Mt - lag(Total_CO2_Mt),
delta_GDP  = GDP_USD - lag(GDP_USD),
# Relative changes (ΔX / X_B)
rel_CO2    = calc_pct_change(Total_CO2_Mt),
rel_GDP    = calc_pct_change(GDP_USD),
# Tapio elasticity DI = rel_CO2 / rel_GDP
DI         = rel_CO2 / rel_GDP,
# Human-readable category using Tapio states
decoupling_state = pmap_chr(
list(delta_c = rel_CO2, delta_gdp = rel_GDP, di = DI),
~ classify_tapio(..1, ..2, ..3)
)
) %>%
ungroup()
# Inspect results table (one row per country-year)
head(decoupling_results)
View(decoupling_results)
state_summary <- decoupling_results %>%
filter(!is.na(decoupling_state)) %>%
count(Country, decoupling_state, name = "n_years") %>%
group_by(Country) %>%
mutate(
share_years = n_years / sum(n_years)
) %>%
ungroup()
# View summary in console
state_summary
p_di <- decoupling_results %>%
ggplot(aes(x = Year, y = DI, color = Country)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey40") +
geom_hline(yintercept = c(0.8, 1.2),
linetype = "dotted", color = "grey60") +
geom_line() +
geom_point() +
scale_y_continuous("Tapio decoupling index (DI)",
labels = number_format(accuracy = 0.1)) +
labs(
title = "Tapio decoupling index (CO2 vs GDP)",
subtitle = "Year-to-year elasticity by country",
x = "Year"
) +
theme(legend.position = "bottom")
print(p_di)
p_states <- decoupling_results %>%
filter(!is.na(decoupling_state)) %>%
ggplot(aes(x = Year, y = Country, fill = decoupling_state)) +
geom_tile(color = "white") +
scale_fill_brewer(palette = "Set3", na.value = "grey90") +
labs(
title = "Decoupling states over time",
subtitle = "Tapio categories for CO2–GDP relationship",
x = "Year",
y = "Country",
fill = "Decoupling state"
)
print(p_states)
# (C) Baseline-based DI for a fixed base year
p_di_base <- decoupling_baseline %>%
ggplot(aes(x = Year, y = DI_base, color = Country)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey40") +
geom_hline(yintercept = c(0.8, 1.2),
linetype = "dotted", color = "grey60") +
geom_line() +
geom_point() +
scale_y_continuous("Tapio decoupling index (DI) vs baseline",
labels = number_format(accuracy = 0.1)) +
labs(
title = paste0("Tapio decoupling index vs ", baseline_year, " baseline"),
subtitle = "CO2 vs GDP for each country",
x = "Year"
) +
theme(legend.position = "bottom")
# View summary in console
state_summary
ggsave("tapio_decoupling_states.png",
p_states, width = 14, height = 12, dpi = 300, bg = "white")
# Create comprehensive performance summary
performance_summary <- decoupling_results %>%
filter(!is.na(decoupling_state)) %>%
group_by(Country) %>%
summarise(
# Count years in each category
Years_Strong_Decoupling = sum(decoupling_state == "strong decoupling"),
Years_Weak_Decoupling = sum(decoupling_state == "weak decoupling"),
Years_Coupling = sum(decoupling_state %in% c("expansive coupling", "recessive coupling")),
Years_Negative_Decoupling = sum(decoupling_state %in% c("expansive negative decoupling", "strong negative decoupling")),
Total_Years = n(),
# Percentages
Pct_Strong_Decoupling = Years_Strong_Decoupling / Total_Years * 100,
Pct_Favorable = (Years_Strong_Decoupling + Years_Weak_Decoupling) / Total_Years * 100,
Pct_Unfavorable = (Years_Coupling + Years_Negative_Decoupling) / Total_Years * 100,
# Recent performance (last 10 years)
Recent_Performance = sum(
decoupling_state[Year >= max(Year) - 9] %in%
c("strong decoupling", "weak decoupling")
) / min(10, sum(Year >= max(Year) - 9)) * 100,
# Overall DI trend
Avg_DI = mean(DI, na.rm = TRUE),
Final_State = last(decoupling_state),
.groups = 'drop'
) %>%
arrange(desc(Pct_Favorable))
# Print formatted table
library(knitr)
kable(
performance_summary %>%
mutate(across(where(is.numeric), ~round(., 2))) %>%
select(
Country, Total_Years,
`% Strong Decoupling` = Pct_Strong_Decoupling,
`% Favorable States` = Pct_Favorable,
`% Unfavorable States` = Pct_Unfavorable,
`% Recent Favorable` = Recent_Performance,
`Avg DI` = Avg_DI,
`Final State` = Final_State
),
caption = "Comprehensive Decoupling Performance Summary (1973-2023)",
align = c('l', rep('c', 7))
)
# Save to CSV
write_csv(performance_summary, "analysis_results/tapio_performance_summary.csv")
# 3.4 Table
# Create comprehensive performance summary
performance_summary <- decoupling_results %>%
filter(!is.na(decoupling_state)) %>%
group_by(Country) %>%
summarise(
# Count years in each category
Years_Strong_Decoupling = sum(decoupling_state == "strong decoupling"),
Years_Weak_Decoupling = sum(decoupling_state == "weak decoupling"),
Years_Coupling = sum(decoupling_state %in% c("expansive coupling", "recessive coupling")),
Years_Negative_Decoupling = sum(decoupling_state %in% c("expansive negative decoupling", "strong negative decoupling")),
Total_Years = n(),
# Percentages
Pct_Strong_Decoupling = Years_Strong_Decoupling / Total_Years * 100,
Pct_Favorable = (Years_Strong_Decoupling + Years_Weak_Decoupling) / Total_Years * 100,
Pct_Unfavorable = (Years_Coupling + Years_Negative_Decoupling) / Total_Years * 100,
# Recent performance (last 10 years)
Recent_Performance = sum(
decoupling_state[Year >= max(Year) - 9] %in%
c("strong decoupling", "weak decoupling")
) / min(10, sum(Year >= max(Year) - 9)) * 100,
# Overall DI trend
Avg_DI = mean(DI, na.rm = TRUE),
Final_State = last(decoupling_state),
.groups = 'drop'
) %>%
arrange(desc(Pct_Favorable))
# Print formatted table
library(knitr)
kable(
performance_summary %>%
mutate(across(where(is.numeric), ~round(., 2))) %>%
select(
Country, Total_Years,
`% Strong Decoupling` = Pct_Strong_Decoupling,
`% Favorable States` = Pct_Favorable,
`% Unfavorable States` = Pct_Unfavorable,
`% Recent Favorable` = Recent_Performance,
`Avg DI` = Avg_DI,
`Final State` = Final_State
),
caption = "Comprehensive Decoupling Performance Summary (1973-2023)",
align = c('l', rep('c', 7))
)
# Save to CSV
write_csv(performance_summary, "tapio_performance_summary.csv")
decoupling_table_year <- decoupling_results %>%
filter(!is.na(decoupling_state)) %>%
select(
Country,
Year,
rel_CO2,
rel_GDP,
DI,
decoupling_state
) %>%
arrange(Country, Year)
# Save as PNG
library(kableExtra)
install.packages("kableExtra")
library(kableExtra)   # For tables
library(kableExtra)   # For tables
install.packages("systemfonts")
install.packages("systemfonts")
library(kableExtra)   # For tables
library(systemfonts)
